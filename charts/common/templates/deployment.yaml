{{/*
  Namespace used to group all the resources for all the environments
    which will be created using this manifest.
    - As this is a Shared resources between environments, we need to check
      if exists, in which case we don't need to create it again.
*/}}
{{ $namespace := (lookup "v1" "Namespace" ""  .Values.resources.namespace) }}
{{- if not $namespace -}}
apiVersion: v1
kind: Namespace
metadata:
  name: {{ .Values.resources.namespace }}
---
{{- end -}}
{{/*
  Secret containing the credentials to authenticate with the Storage Account
    for accessing the File Shares used by the Persistent Volumes.
    - As this is a Shared resources between environments, we need to check
      if exists, in which case we don't need to create it again.
*/}}
{{ $azureFilesSecret := (lookup "v1" "Secret" .Values.resources.namespace  "azure-file-credentials") }}
{{- if not $azureFilesSecret -}}
apiVersion: v1
kind: Secret
metadata:
  name: azure-file-credentials
  namespace: {{ .Values.resources.namespace }}
type: Opaque
stringData:
  azurestorageaccountname: {{ quote .Values.resources.storageAccount.name }}
  azurestorageaccountkey: {{ quote .Values.resources.storageAccount.key }}
---
{{- end -}}
{{ $tlsSecret := (lookup "v1" "Secret" .Values.resources.namespace .Values.resources.ingress.tls.name) }}
{{{{- if not $tlsSecret -}}
apiVersion: v1
kind: Secret
metadata:
  name: tls-certificate
  namespace: {{ .Values.resources.namespace }}
data:
  tls.crt: >-
    LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tDQpNSUlHUlRDQ0JTMmdBd0lCQWdJUkFNR1VmZGIvaHpGTWRuVHZFL0NmODBVd0RRWUpLb1pJaHZjTkFRRUxCUUF3DQpnWTh4Q3pBSkJnTlZCQVlUQWtkQ01Sc3dHUVlEVlFRSUV4SkhjbVZoZEdWeUlFMWhibU5vWlhOMFpYSXhFREFPDQpCZ05WQkFjVEIxTmhiR1p2Y21ReEdEQVdCZ05WQkFvVEQxTmxZM1JwWjI4Z1RHbHRhWFJsWkRFM01EVUdBMVVFDQpBeE11VTJWamRHbG5ieUJTVTBFZ1JHOXRZV2x1SUZaaGJHbGtZWFJwYjI0Z1UyVmpkWEpsSUZObGNuWmxjaUJEDQpRVEFlRncweU5EQXhNVEV3TURBd01EQmFGdzB5TlRBeU1UQXlNelU1TlRsYU1COHhIVEFiQmdOVkJBTU1GQ291DQpZV05qYjNWdWRHVnljSEpwYzJVdVkyOXRNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDDQpBUUVBc1krSmpmTWI0ODBhUm9EV0QyZ0N2TS9VZWQ2NGloK3Q5cUZsS0xacFZIK3lBK3lwV2tMaUFCMnFCcDY3DQovbXRxVmlmZWNPYTZneGhoSUlEWFh5azc4TklsV201emxJUklMWmVaUVc3bVFCRzlBRHA0STQxNzA2VkJ4QUVKDQppLzdCRzZsUG9LVUpqVmMrTWlIS2lLUGhpdTBzOThCbGszVzl5eGpNSlRLeFdGbTBqandjWjBLZ1lzbjB2SG04DQpJckdzaENmVzNpcmdGTmJlL2RQL0lyNnNXVnB3dWlUUlZlQzF5SENxd3JuTGI4R2pQWEtNaDVHWnJzMlFmdmEyDQo3UWJmckZVVi9Udk1UczdWWXluQjNHNWoweUduRTN6TlUyMHFDR2JwQlRSazJaVG1lcWNySUppNUJodW1ETFhlDQpiVThvdDJOdGprb1cwemNicFFSQ1YzcVdQd0lEQVFBQm80SURDVENDQXdVd0h3WURWUjBqQkJnd0ZvQVVqWXhlDQp4RlN0aXVGMzZadjVtd1hodUFHTlllRXdIUVlEVlIwT0JCWUVGRlRzYWE1RUErU0V6RVp4ZzlXY1Iwc3M3UnN1DQpNQTRHQTFVZER3RUIvd1FFQXdJRm9EQU1CZ05WSFJNQkFmOEVBakFBTUIwR0ExVWRKUVFXTUJRR0NDc0dBUVVGDQpCd01CQmdnckJnRUZCUWNEQWpCSkJnTlZIU0FFUWpCQU1EUUdDeXNHQVFRQnNqRUJBZ0lITUNVd0l3WUlLd1lCDQpCUVVIQWdFV0YyaDBkSEJ6T2k4dmMyVmpkR2xuYnk1amIyMHZRMUJUTUFnR0JtZUJEQUVDQVRDQmhBWUlLd1lCDQpCUVVIQVFFRWVEQjJNRThHQ0NzR0FRVUZCekFDaGtOb2RIUndPaTh2WTNKMExuTmxZM1JwWjI4dVkyOXRMMU5sDQpZM1JwWjI5U1UwRkViMjFoYVc1V1lXeHBaR0YwYVc5dVUyVmpkWEpsVTJWeWRtVnlRMEV1WTNKME1DTUdDQ3NHDQpBUVVGQnpBQmhoZG9kSFJ3T2k4dmIyTnpjQzV6WldOMGFXZHZMbU52YlRBekJnTlZIUkVFTERBcWdoUXFMbUZqDQpZMjkxYm5SbGNuQnlhWE5sTG1OdmJZSVNZV05qYjNWdWRHVnljSEpwYzJVdVkyOXRNSUlCZlFZS0t3WUJCQUhXDQplUUlFQWdTQ0FXMEVnZ0ZwQVdjQWRnRFBFVmJ1MVM1OHIvT0hXOWxwTHB2cEduRm5TckFYN0t3QjBsdDN6c3c3DQpDQUFBQVl6NnFhb3dBQUFFQXdCSE1FVUNJUUNOcXpQN1JMSk8zYnlmc2g1RXlscVR0WXJoOXNCdmtxMFFoNTZRDQplNWh5V2dJZ2NPVXJQWnIyM3BqNnprcldQdndVNG5rNXl3ZzNBYi9RS1lYbDJtMHJNS2dBZGdDaTR3cmtSZSs5DQpyWnQrT08xSFozZFQxNEpiaEpUWEsxNGJMTVM1VUtSSDV3QUFBWXo2cWFvOEFBQUVBd0JITUVVQ0lRQzVldFpsDQpTNnJpV25FbVN3UUFtaFdEZDk1U1pSaDQwT0NOUzQxdkNyRHhJZ0lnRzlIYjFCdWs4V0dmVGxkaEQzMFc3ajZGDQpFM1ppSlBKTVhERXZJcDhYR2RNQWRRQk9kYU1uWEpvUXd6aGJiTlRmUDFMckhmRGdqaHVOYWNDeCttU3hZcG81DQozd0FBQVl6NnFhblRBQUFFQXdCR01FUUNJRlBUM25zdFAyMVgzNzJQVGttcTNrWkU0aGFsT050d0NFYjhjdkorDQp3Nmh3QWlCMGhNVGFPOGxwekdoZjlXeVFaVUhOZSs0VkJmZ3RsVVZnbXpwRFc3bFRaREFOQmdrcWhraUc5dzBCDQpBUXNGQUFPQ0FRRUFRKzdEU016Snl1TFkrR2tMZHpWQ2dmcnlCL0t4L0tnTldjNk1lTkFEVXQ1SDBtcmZVOUxhDQpULzRISVNGb2xtRE9XbXpCTTZzdkh0ZExKTGNLaXdOWnprSWNnWGJ4bWt1bGhoZWt6OUtuaHhIOW1jSkVHWG51DQpvYXRJK1BzckZweFJhS0hoclEyTEYxUHhBcjgrWmNnV0JSdE1rU2Y5dTM2OGgxUW8vTG9nUEZ2S1RMTXFuNjJ6DQozdTdjTSt1ZFkyYng1VDBDSkxlMDZQWGwvbERqdUljZXJPWTZqalFxT1dERG41T2hFZitnOUZ1dkxybkhvZDMwDQpuVk1FY3FJeHR4YjZTTjJQY2JpTnUxakhpaXRTVDA3V2dYSTlrZGdkVzlLVWZRd1kwMitrSVFxWWo3OVZQRkpaDQpzam9qZThwVzQ2cXRQRnpHcE9ubSs1bVp3NjN0WWZBeXBnPT0NCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0NCg==
  tls.key: >-
    LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tDQpNSUlFdkFJQkFEQU5CZ2txaGtpRzl3MEJBUUVGQUFTQ0JLWXdnZ1NpQWdFQUFvSUJBUUN4ajRtTjh4dmp6UnBHDQpnTllQYUFLOHo5UjUzcmlLSDYzMm9XVW90bWxVZjdJRDdLbGFRdUlBSGFvR25ydithMnBXSjk1dzVycURHR0VnDQpnTmRmS1R2dzBpVmFibk9VaEVndGw1bEJidVpBRWIwQU9uZ2pqWHZUcFVIRUFRbUwvc0VicVUrZ3BRbU5WejR5DQpJY3FJbytHSzdTejN3R1dUZGIzTEdNd2xNckZZV2JTT1BCeG5RcUJpeWZTOGVid2lzYXlFSjliZUt1QVUxdDc5DQowLzhpdnF4WlduQzZKTkZWNExYSWNLckN1Y3R2d2FNOWNveUhrWm11elpCKzlyYnRCdCtzVlJYOU84eE96dFZqDQpLY0hjYm1QVElhY1RmTTFUYlNvSVp1a0ZOR1RabE9aNnB5c2dtTGtHRzZZTXRkNXRUeWkzWTIyT1NoYlROeHVsDQpCRUpYZXBZL0FnTUJBQUVDZ2dFQUxrWnlXd1JZNkcyencxd2diYk4xd3krRytKd0xERFJsYWpsMTI3NXVoUThpDQpuZE0zNzhZdWtFa3EzcjdQeithK3QrVjhHNENHYTFRWFBCbFlCL3ovR2l3cWYvNzVNR09wUy9pT2dIY2VtdVFFDQpsZUtuSE56cXdLWDVGZFFQWU9Uci93R0pOeHpMK0lJY080U0MvRWw1cG5OWm5OZ1BvUGEybUEvR1pJdHBuTlNVDQpseS9wN0JEQmNyR1F6NlptSmdldTUwbFQwWGlVUE9nY1ZrSDVkSGYzOHFYcGN3SzhzTGY0UUZaUktVcmN0OWRSDQpreWJ6bFRXcFYxL2FUUGgyMml4czM3Ylk2bVhybHE0S0lCbUlDQUF3SmI3RXdQdVRTd1JQcEYrV2RmeW1XeFNODQpQM1VneDlmVjlqaUdTTGU2cG5SbER4TDJCd3kvUnJoajRFSjkvU29MUVFLQmdRRHAxR0xJd0QvMUdYOU1FQjd0DQpVU2JYV3l4SGdieGFJV21MNXlwTTl6N0swOGJNL3I1bEdyVHJTbjQxSTVHNGxDVmRRcXUzcm5PYjJHY3ptaXZpDQpocnlmclNRRFBtQXp4NTJOT29sbHM0Sm9QTFNVZHl2Y2p4MGMyVzVxUEZ6QW9yS25ZaDQrQWxhNTRGa0Nxbk94DQpyMnBrN01LcHFaT0VkbFJMVkpzei93Q2l2UUtCZ1FEQ1pWNEw0NFhpUlllRXpaU2l2eHYzRytqTzNwV0c4cVIyDQpmRCt6L2VudWpXY1h5WnN2b0d3TDFobUd4aStKcFA0WWY0Rk9BdE51ZVZXcnVFUC9hQW9kU0Npcm00QzhxNzFTDQpCTmJxV0lWMTdFdVUxU1dYR1JlbjJqVmRmS2U3MXdqNHBwYVhqT3dPaGs2OXZwMjdrOUlnYlZjdnFMZnFjU2U0DQprQnJuUXVTS3F3S0JnQmxWQlE2eXBUc3NjL29ObFF3b3lvaHlQQzNUQkZEUFpkdmVRMXJyUGtaREF6cWFMbzVODQpnbVFyUWRrSDdYV050eTZQVm9Nanh5cVBHejhmNkxrMTE2R0U1RzNsaUE2VUJhR1RRZWRldHpZTHZaU0lCSngwDQpkTGIzWjFyakJ6bG5adXR6V2N0bC9YZE5zdGJ6R0cyYmoyODNweTh5UytVQjNNZjhkb1Ava0ZZUkFvR0FPcFhnDQpKUWNaNTFwN0FCd1E2b2RiL3pvTERLVnFQUFJOZW1QeHN1WVlKVXU2UVNJQ1FmVS8rc1U0aGpTZVNRWlBpY1NMDQpqSjR2YUVEcS84aVZ2WmgyUytMZVZ2R1RkOGp1VXBTZ3pKbUhCMFlDZFVWVGdka1BGd2dkUXlKNVRwUDg0U3NiDQpnV3I0RFZ5T3lJSjArUDRRdXJNWkxvVFRnTFUvZWxEN3VxeWZRZWNDZ1lCZmhnZytMUTY4YUFIaW5nZE9Wem9ZDQpzdW1iL1Y3dWhKdk9CWmNSajdpRGFhbzk1VWl1NHp5N0ZxcHNNK1dkbmpPdDJiV1RCVWVhUlUzMFhaTEZ5OHdrDQphZmJCR0QxaW85RzRuaXRyRDhtTkRmYzRoMkhMa0hETXN6ZlltLzBmZ1UxZHZsNDFhT0lqc3JQN28wbE1uTThJDQpRaVp4M21pbUYveWV2SjhibUZ6TE53PT0NCi0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0NCg==
type: kubernetes.io/tls
---
{{- end -}}}}